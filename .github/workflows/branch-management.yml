name: Branch Management

on:
  schedule:
    - cron: '0 0 * * *' # Runs at midnight ET (us-east-1)
  workflow_dispatch:

env:
  NEON_API_KEY: ${{ secrets.NEON_API_KEY }}
  NEON_PROJECT_IDS: 'little-salad-54029192,autumn-bush-97691534'
  # branch-management-dev : little-salad-54029192
  # branch-management-test : autumn-bush-97691534
  # NEON_PROJECT_IDS: '${{ secrets.DEV_DATABASE_ID }},${{ secrets.TEST_DATABASE_ID }}'

jobs:
  dump-and-restore:
    runs-on: ubuntu-latest

    steps:
      - name: Install Neon CLI
        run: npm install -g neonctl@latest

      - name: Verify Neon CLI install
        run: |
          neon --version

      - name: List Projects
        run: |
          neon projects list
